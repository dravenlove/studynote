# JSON库的学习 #

## JSON的定义 ##

JSON是一种用于数据交换的文本格式,现在的标准为ECMA-404.

JSON是树状结构,只包括六种数据类型:

1.null表示为null.
2.Boolean表示为true或false.
3.number表示浮点数的表示方式.
4.string表示"".
5.array表示[].
6.object表示{}.


JSON库主要是完成三个需求:
1.把JSON文件解析为一个树状数据结构.
2.提供接口访问该数据结构.
3.把数据结构转换成JSON文本.

## 搭建编译环境 ##

### 在VSCODE平台上安装CMake环境 ###

1.需要安装的工具(Vs Code,CMake,CMake Tools)
2.CTRL+SHIFT+P检索CMake。
3.选择合适的编译器，如果检索不到可以用locate选择有CMakelists.txt所在的目录。


JSON库代码文件:
1. (.h文件)是头文件,头文件包含对外的类型和API函数的声明.
2. (.c文件)是实现文件,含有内部的类型声明和函数实现,此文件会编译成库.
3. (test.c文件)测试驱动开发.它需要链接leptjson库。

JSON有六种数据类型，如果把true和false当作两个类型就是7种，分别是null、false、true、number、string、array、object。

因为C语言没有C++命名空间namespace功能,一般会使用项目的简写作为标识符前缀,枚举值用全大写,类型和函数用小写.

声明JSON的数据结构,JSON是一个树形结构,最终需要实现一个树的数据结构,每个节点用结构体表示,我们称它为一个JSON值.
在这个单元中.我们需要实现null,true和false的解析,这个结构只存储一个类型,之后的单元会加入其他数据.

C语言的结构体是struct X {}形式声明的，定义变量也要写成struct X x；

API函数:

解析JSON的API函数：

``` int lept_parse(lept_value* v, const char* json);```

传入JSON文本一个C字符串(空结尾字符串/null-terminated string),我们不应该改动这个输入字符,要用const char*字符.

传入节点指针v由使用方分配:

    lept_value v;
    const char json[]=...;
    int ret = lept_parse(&v,json);

返回值是以下枚举值，无错误会返回LEPT_PARSE_OK:

    enum{
        LEPT_PARSE_OK=0,
        LEPT_PARSE_EXPECT_VALUE,
        LEPT_PARSE_INVALID_VALUE,
        LEPT_PARSE_ROOT_NOT_SINGULAR
    };

    lept_type lept_get_type(const lept_value* v);

## JSON语法子集 ##

RFC7159中ABNF表示:

    JSON-text = ws value ws
    ws = *(%x20/%x09/%x0A/%x0D)
    value = null / false / true 
    null  = "null"
    false = "false"
    true  = "true"

%xhh表示以16进制表示的字符,/是多选一,*是零或多个,()用于分组.

JSON文本由三部分组成:

首先是空白(whitespace),接着是一个值(value),最后是空白(whitespace).

所谓空白,是由零和多个空格符(space U+0020)、制表符(tab U+0009)、换行符(LF U+000A)、回车符(CR U+000D)所组成.

现时的值只可以是null、false、true，分别有对应的字面值。

在这个JSON语法子集下，我们定义三种错误码：

1.若一个JSON只含有空白、传回LEPT_PARSE_EXPECT_VALUE。
2.若一个值之后，空白之后还有其他字符，传回LEPT_PARSE_ROOT_NOT_SINGULAR。
3.若值不是那三种字面值，传回LEPT_PARSE_INVALID_VALUE。

## 单元测试 ##



